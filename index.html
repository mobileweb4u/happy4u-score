<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>HAPPY4U Scoreboard v2.4.1</title>

<link rel="icon" type="image/png" href="favicon.png">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#00ff44">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-icon" href="icon-192.png">

<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
/* 3-BUTTON ROW LAYOUT */
.menu-grid {
display: grid;
grid-template-columns: repeat(3, 1fr);
gap: 10px;
width: 100%;
}

.menu-btn {
font-size: 0.7rem;
padding: 10px 2px;
text-align: center;
white-space: nowrap;
}

/* Forces the Close button to occupy its own line at the bottom */
#close-info-btn {
grid-column: span 3;
margin-top: 20px;
background: none;
border: none;
color: gray;
cursor: pointer;
}

/* ROTATION WARNING ELEMENT */
#rotation-warning {
display: none;
position: fixed;
inset: 0;
background: #000;
color: #39FF14;
z-index: 99999;
flex-direction: column;
justify-content: center;
align-items: center;
text-align: center;
padding: 20px;
}

@media (orientation: portrait) {
#rotation-warning { display: flex; }
}

/* Version Badge Styling */
.version-badge {
font-size: 0.75rem;
vertical-align: middle;
opacity: 0.9;
background: var(--neon-green);
color: #000; 
padding: 3px 6px;
border-radius: 3px;
margin-left: 8px;
transition: all 0.3s ease;
font-weight: bold;
display: inline-block;
line-height: 1;
}

@keyframes pulse-green {
0% { box-shadow: 0 0 0 0 rgba(0, 255, 68, 0.7); }
70% { box-shadow: 0 0 0 10px rgba(0, 255, 68, 0); }
100% { box-shadow: 0 0 0 0 rgba(0, 255, 68, 0); }
}

.update-success {
animation: pulse-green 2s infinite;
background-color: var(--neon-green) !important;
color: #000 !important;
font-weight: bold;
}

.reset-storage-btn {
background: none;
border: 1px solid #ff4444;
color: #ff4444;
font-size: 0.6rem;
padding: 2px 8px;
border-radius: 4px;
cursor: pointer;
margin-left: 10px;
transition: 0.3s;
}

.reset-storage-btn:hover {
background: #ff4444;
color: white;
}

/* --- FIXED TICKER STYLING (THE FIX) --- */
.ticker-wrap {
    width: 100%;
    overflow: hidden;
    background-color: #000 !important;
    border-top: 1px solid #333;
    border-bottom: 1px solid #333;
    height: 48px !important;
    display: flex;
    align-items: center;
}

.ticker {
    font-size: 1.3rem !important;
    font-weight: 800 !important;
    color: #00ff44 !important;
    white-space: nowrap;
    line-height: 48px;
}

.ticker span {
    color: #ff00ff !important;
    font-weight: bold;
}

.ticker-highlight {
    color: #00ff44 !important;
    font-weight: bold;
}

/* --- TOOLTIP SYSTEM --- */
.bottom-nav {
    overflow: visible !important;
}

.nav-icon {
    position: relative;
    cursor: pointer;
}

.nav-icon[data-tooltip]:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    bottom: 160%;
    left: 50%;
    transform: translateX(-50%);
    background: #111;
    color: #fff;
    font-size: 0.65rem;
    font-weight: bold;
    padding: 6px 10px;
    border: 1px solid #00f2ff; /* cyber-cyan */
    border-radius: 4px;
    white-space: nowrap;
    box-shadow: 0 0 10px rgba(0, 242, 255, 0.5);
    z-index: 99999;
}

.nav-icon[data-tooltip]:hover::before {
    content: "";
    position: absolute;
    bottom: 140%;
    left: 50%;
    transform: translateX(-50%);
    border-width: 6px;
    border-style: solid;
    border-color: #00f2ff transparent transparent transparent;
    z-index: 99999;
}

</style>
</head>
<body>
<div id="rotation-warning">
<i class="fas fa-sync-alt fa-3x" style="margin-bottom: 20px;"></i>
<h2>PLEASE ROTATE DEVICE</h2>
<p>Landscape mode is required for the scoreboard.</p>
</div>

<header>
<h1 class="brand">HAPPY4U <span id="header-v-badge" class="version-badge">v2.4.1</span></h1>
<h1 class="title" id="main-title">Race To <span id="race-goal-display" style="color: var(--neon-green);">3</span></h1>
<button id="end-game-btn" class="end-game">END GAME</button>
</header>

<div class="ticker-wrap">
<div class="ticker" id="news-ticker">
<span>NEWS FLASH:</span> MATCH STARTING...
&nbsp;&nbsp;&nbsp; ‚Ä¢ &nbsp;&nbsp;&nbsp;
RACE TO 3 IN PROGRESS...
</div>
</div>

<main class="scoreboard">
<section class="player-column" id="p1-section">
<h2 class="player-name">
<span id="p1-break-indicator" style="visibility: hidden; color: var(--neon-magenta); margin-right: 10px;">‚òÖ BREAK</span>
<span id="p1-name-display">Player 1</span>
</h2>
<div class="match-wins">Races Won: <span id="p1-matches">0</span></div>
<div class="score-box" id="p1-box">
<div class="score-display" id="p1-score">0</div>
</div>
<div class="dish-stats">Break Dishes: <span id="p1-dishes">0</span></div>
<div class="dish-stats">Reverse Dishes: <span id="p1-rev-dishes">0</span></div>
<div style="margin-top: 20px;">
<button class="btn-plus" data-player="p1">WIN FRAME</button>
</div>
</section>

<section class="player-column" id="p2-section">
<h2 class="player-name">
<span id="p2-name-display">Player 2</span>
<span id="p2-break-indicator" style="visibility: hidden; color: var(--neon-magenta); margin-left: 10px;">‚òÖ BREAK</span>
</h2>
<div class="match-wins">Races Won: <span id="p2-matches">0</span></div>
<div class="score-box" id="p2-box">
<div class="score-display" id="p2-score">0</div>
</div>
<div class="dish-stats">Break Dishes: <span id="p2-dishes">0</span></div>
<div class="dish-stats">Reverse Dishes: <span id="p2-rev-dishes">0</span></div>
<div style="margin-top: 20px;">
<button class="btn-plus" data-player="p2">WIN FRAME</button>
</div>
</section>
</main>

<footer class="bottom-nav">
<span class="nav-icon">üè†</span>
<span class="nav-icon info-icon" data-tooltip="MAIN MENU">‚ìò</span>
<span class="nav-icon star-icon" id="view-progress-btn" data-tooltip="VIEW PROGRESS">‚òÖ</span>
<span class="nav-icon">üë§</span>
</footer>

<script src="script.js"></script>

<script>
    let deferredPrompt;
    const pwaBtn = document.getElementById('pwa-install-trigger');

    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        if(pwaBtn) pwaBtn.style.display = 'block'; 
    });

    if(pwaBtn) {
        pwaBtn.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                if (outcome === 'accepted') pwaBtn.style.display = 'none';
                deferredPrompt = null;
            }
        });
    }

    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js')
          .then(() => console.log("HAPPY4U Offline Engine: Active"));
    }
</script>
</body>
</html>
